ARCO
====

Screening charcoal peaks in macrocharcoal-area records for fire-episode reconstructions
---
This R function screens charcoal peaks for charcoal-area records used to reconstruct past fire episodes with the CharAnalysis software, as described in Finsinger et al. (2014). 
 
For additional details, please refer to Finsinger et al. (2014), or contact: 
Walter Finsinger <walter.finsinger@umontpellier.fr> or 
Ryan Kelly <rkelly@life.illinois.edu>. 

NOTE: as of February 2023, this stand-alone arco() function has been included
in the 'tapas' package. See https://github.com/wfinsinger/tapas for further
details.
 
The R function requires four data frames, as well as the following additional parameters: 
---
n.boot = number of bootstrap samples generated by the function to obtain a distribution of simulated charcoal-areas (default = 10,000) 
 
thresh.prob = pth percentile threshold used to separate significant charcoal-area peaks (default = 0.95) 

win.width = temporal span of the window from which bootstrap samples are generated. For each peak to be screened, particles are randomly drawn (with replacement) from all samples within a local window, which is centered on the peak and has a full span of win.width (default = 1000).

breakage = if FALSE plots also C/CA-ratios in diagnostic plot (default = FALSE)

ff_sm_yr    = Window to smooth peak frequencies over, in years (default = 1000)

output.dir  = path for output data and figures
              (default = 'arco_output' in current working directory)
 
----------------------------------------------------------------------------------------
Input data
--
The input datasets should be data frames.
Details of the four data frames are below, and examples are included with this R code: 
 
A) RAW DATA
1. Seedle.file = a data frame with charcoal-particle areas.
    Should have two columns and as many rows as the number of observations
    (i.e. charcoal particles; see the example file 'arco_Seedle.csv'): 
 
Column 1: Depth = Depth of samples 
Column 2: SdlArea = Charcoal-particle areas 
 
2. Smpl.file = A data frame with charcoal counts and charcoal areas.
   Should have four columns and as many rows as the number of samples
   (see the example file 'arco_Smpl.csv'): 
 
Column 1: Depth = Depth of samples

Column 2: Age_calBP = Age estimate of samples 

Column 3: SmplCount = Number of charcoal particles in each sample 

Column 4: SmplArea = Cumulative charcoal area in each sample 
 
B) FIRE-EPISODE RECONSTRUCTIONS. 
These are output files from the CharAnalysis program (Higuera et al. 2009), which is freely available (http://phiguera.github.io/CharAnalysis/). 
 
3. FireA.file = CharAnalysis output table from analysis of CHARCOAL AREAS (WITHOUT minimum count test, i.e. with CharAnalysis parameter 'minCountP' = 1.0)
4. FireC.file = CharAnalysis output table from analysis of CHARCOAL COUNTS and WITH minimum count test, i.e. with CharAnalysis parameter 'minCountP' < 1.0 (e.g. 0.05 as in Higuera et al. [2009])
 
*** Note: CharAnalysis files must have columns in the expected order, specifically: 
 
Column 2: "age Top_i", the age at the top of the interpolated sample 

Column 8: "char Peak", the Cpeak component of CHAR 

Column 12: "thresh FinalPos", the threshold used for peak identification 

Column 19: "peaks Final", the boolean series representing identified peaks 

----------------------------------------------------------------------------------------

See the 'example_arco.r' file for a simple guide on how to
- load the data into the R environment, and
- run the function.

----------------------------------------------------------------------------------------

References: 
-
Finsinger, W., R. Kelly, J. Fevre, and E.K. Magyari. 2014. A guide to screening charcoal peaks in macrocharcoal-area records for fire episode reconstructions. The Holocene XX: XXXX. doi: 10.1177/0959683614534737 (http://dx.doi.org/10.1177/0959683614534737)

Kelly R, Higuera PE, Barrett CM, Hu FS (2011) A signal-to-noise index to quantify the potential for peak detection in sediment–charcoal records. Quaternary Research 75:11–17. doi: 10.1016/j.yqres.2010.07.011
(http://dx.doi.org/10.1016/j.yqres.2010.07.011)
 
Higuera, P.E., L.B. Brubaker, P.M. Anderson, F.S. Hu, and T.A. Brown. 2009. Vegetation mediated the impacts of postglacial climate change on fire regimes in the south-central Brooks Range, Alaska. Ecological Monographs 79:201–219. http://dx.doi.org/10.1890/07-2019.1)
 
----------------------------------------------------------------------------------------
